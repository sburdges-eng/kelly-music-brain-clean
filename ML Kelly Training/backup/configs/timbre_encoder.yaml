# =============================================================================
# Timbre Encoder Training Configuration
# =============================================================================
# Task: Encode audio timbre into latent space
# Target: Real-time encoding (<5ms)
# Architecture: Variational Autoencoder (VAE)
# =============================================================================

# Model Identity
model_id: timbreencoder
model_type: RTNeural
task: timbre_encoding

# Architecture
# Input: Mel spectrogram (64 mel Ã— 64 time)
# Output: 64-dim latent timbre vector
input_size: 4096
output_size: 64
hidden_layers: [512, 256, 128]
activation: relu
dropout: 0.2

# Use VAE architecture
architecture_type: vae
vae_config:
  encoder_channels: [32, 64, 128, 256]
  decoder_channels: [256, 128, 64, 32]
  latent_dim: 64
  kl_weight: 0.0001  # Beta-VAE weight

# Data Configuration
data_path: /Volumes/Extreme SSD/kelly-audio-data/raw/timbres
data_version: v1
sample_rate: 22050
n_mels: 64
n_fft: 2048
hop_length: 512
segment_frames: 64

# Timbre categories (for supervised component)
timbre_categories:
  - bright
  - dark
  - warm
  - cold
  - harsh
  - smooth
  - rich
  - thin

# Split ratios
train_split: 0.8
val_split: 0.1
test_split: 0.1

# Training Parameters (Mac-optimized)
epochs: 150
batch_size: 32
learning_rate: 0.0003
optimizer: adam
weight_decay: 0.0001
loss: vae_loss  # Reconstruction + KL divergence
scheduler: cosine
warmup_epochs: 10

# Early stopping
early_stopping_patience: 20
min_delta: 0.0001

# Mac-specific settings
device: auto
num_workers: 0
pin_memory: false

# Augmentation
augmentation:
  pitch_shift: [-3, 3]
  time_stretch: [0.9, 1.1]
  noise_injection: 0.01

# Output
output_dir: checkpoints/timbre_encoder
export_onnx: true
export_coreml: true

# Logging
log_interval: 20
save_interval: 10
log_reconstructions: true

# Evaluation metrics
metrics:
  - reconstruction_loss
  - kl_divergence
  - latent_variance
  - perceptual_loss

# Metadata
author: ""
notes: "VAE for timbre encoding and manipulation"

